@model TiendaPlayeras.Web.Models.Product
@{
    ViewData["Title"] = "Agregar Producto";
}

<link rel="stylesheet" href="~/css/kaira/create_producto.css">

<div class="create-container">
    <div class="container">
        <!-- Header mejorado -->
        <div class="create-header">
            <h1>
                <i class="fas fa-plus-circle"></i>
                Crear Nuevo Producto
            </h1>
            <p>Completa la información para agregar un producto a tu catálogo</p>
        </div>

        <div class="form-card">
            <form asp-action="Create" method="post" enctype="multipart/form-data" id="productForm">
                @Html.AntiForgeryToken()

                <!-- ================================================
                     SECCIÓN: INFORMACIÓN BÁSICA
                     ================================================ -->
                <div class="form-section">
                    <div class="section-title">
                        <i class="fas fa-info-circle"></i>
                        Información Básica
                    </div>

                    <div class="row g-4">
                        <!-- Nombre del Producto -->
                        <div class="col-md-12">
                            <label class="form-label">
                                <i class="fas fa-tag"></i>
                                Nombre del Producto
                                <span class="required">*</span>
                            </label>
                            <div class="input-icon">
                                <input asp-for="Name" 
                                       class="form-control" 
                                       placeholder="Ej: Playera Mustang Classic"
                                       required 
                                       maxlength="200"
                                       id="productName" />
                                <i class="fas fa-tshirt"></i>
                            </div>
                            <span asp-validation-for="Name" class="text-danger"></span>
                            <div class="char-counter">
                                <i class="fas fa-keyboard me-1"></i>
                                <span id="nameCounter">0</span> / 200 caracteres
                            </div>
                            <div class="slug-preview" id="slugPreview">
                                <i class="fas fa-link me-2"></i>
                                <span>URL: <strong id="slugText"></strong></span>
                            </div>
                        </div>

                        <!-- Descripción del Producto -->
                        <div class="col-md-12">
                            <label class="form-label">
                                <i class="fas fa-align-left"></i>
                                Descripción del Producto
                            </label>
                            <textarea asp-for="Description" 
                                      class="form-control" 
                                      placeholder="Describe las características, materiales, y detalles importantes del producto..."
                                      rows="5"
                                      maxlength="1000"
                                      id="productDescription"></textarea>
                            <div class="helper-text">
                                <i class="fas fa-lightbulb"></i>
                                Una buena descripción ayuda a tus clientes a tomar decisiones de compra informadas
                            </div>
                            <div class="char-counter">
                                <i class="fas fa-keyboard me-1"></i>
                                <span id="descCounter">0</span> / 1000 caracteres
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ================================================
                     SECCIÓN: IMÁGENES DEL PRODUCTO
                     ================================================ -->
                <div class="form-section">
                    <div class="section-title">
                        <i class="fas fa-images"></i>
                        Imágenes del Producto
                        <span class="badge bg-primary ms-2" id="imagesCount">0 imágenes</span>
                    </div>

                    <!-- Área de carga -->
                    <div class="images-upload-area" onclick="document.getElementById('imagesInput').click()">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <h5>Haz clic para seleccionar imágenes</h5>
                        <p class="text-muted mb-0">o arrastra y suelta aquí</p>
                        <input type="file" 
                               id="imagesInput"
                               name="images" 
                               accept=".jpg,.jpeg,.png,.webp,.gif" 
                               multiple
                               style="display: none;" />
                    </div>
                    
                    <div class="helper-text">
                        <i class="fas fa-info-circle"></i>
                        Formatos: JPG, PNG, WebP, GIF — Máximo 10MB por imagen — La primera será la imagen principal
                    </div>

                    <!-- Estado de carga -->
                    <div class="upload-status" id="uploadStatus"></div>

                    <!-- Vista previa de imágenes -->
                    <div class="images-preview-grid" id="imagesPreview">
                        <div class="no-images-message" id="noImagesMessage">
                            <i class="fas fa-image me-2"></i>
                            No hay imágenes seleccionadas
                        </div>
                    </div>
                </div>

                <!-- ================================================
                     SECCIÓN: TALLAS DISPONIBLES
                     ================================================ -->
                <div class="form-section">
                    <div class="section-title">
                        <i class="fas fa-ruler"></i>
                        Tallas Disponibles
                    </div>

                    <div class="row g-4">
                        <div class="col-12">
                            <label class="form-label">
                                <i class="fas fa-tshirt"></i>
                                Selecciona las tallas disponibles para este producto
                            </label>
                            <div class="size-options-grid">
                                <div class="form-check form-check-size">
                                    <input class="form-check-input" 
                                           type="checkbox" 
                                           name="availableSizes" 
                                           value="S" 
                                           id="sizeS" 
                                           checked>
                                    <label class="form-check-label" for="sizeS">
                                        S
                                    </label>
                                </div>
                                <div class="form-check form-check-size">
                                    <input class="form-check-input" 
                                           type="checkbox" 
                                           name="availableSizes" 
                                           value="M" 
                                           id="sizeM" 
                                           checked>
                                    <label class="form-check-label" for="sizeM">
                                        M
                                    </label>
                                </div>
                                <div class="form-check form-check-size">
                                    <input class="form-check-input" 
                                           type="checkbox" 
                                           name="availableSizes" 
                                           value="L" 
                                           id="sizeL" 
                                           checked>
                                    <label class="form-check-label" for="sizeL">
                                        L
                                    </label>
                                </div>
                                <div class="form-check form-check-size">
                                    <input class="form-check-input" 
                                           type="checkbox" 
                                           name="availableSizes" 
                                           value="XL" 
                                           id="sizeXL" 
                                           checked>
                                    <label class="form-check-label" for="sizeXL">
                                        XL
                                    </label>
                                </div>
                            </div>
                            <input type="hidden" id="availableSizesHidden" name="availableSizes">
                            <div class="helper-text">
                                <i class="fas fa-info-circle"></i>
                                Las tallas seleccionadas estarán disponibles para los clientes en la tienda
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ================================================
                     SECCIÓN: PRECIO Y CONFIGURACIÓN
                     ================================================ -->
                <div class="form-section">
                    <div class="section-title">
                        <i class="fas fa-dollar-sign"></i>
                        Precio y Configuración
                    </div>

                    <div class="row g-4">
                        <!-- Precio Base -->
                        <div class="col-md-6">
                            <label class="form-label">
                                <i class="fas fa-money-bill-wave"></i>
                                Precio Base
                                <span class="required">*</span>
                            </label>
                            <div class="price-input-group">
                                <span class="currency-symbol">$</span>
                                <input asp-for="BasePrice" 
                                       type="number" 
                                       step="0.01" 
                                       min="0" 
                                       max="999999"
                                       class="form-control" 
                                       placeholder="0.00"
                                       required />
                            </div>
                            <span asp-validation-for="BasePrice" class="text-danger"></span>
                            <div class="helper-text">
                                <i class="fas fa-info-circle"></i>
                                Precio base del producto antes de aplicar cualquier descuento
                            </div>
                        </div>

                        <!-- Estado del Producto -->
                        <div class="col-md-6">
                            <label class="form-label">
                                <i class="fas fa-toggle-on"></i>
                                Estado del Producto
                            </label>
                            <div class="form-check">
                                <input asp-for="IsActive" 
                                       class="form-check-input" 
                                       type="checkbox" 
                                       checked 
                                       id="isActiveCheck" />
                                <label class="form-check-label" for="isActiveCheck">
                                    <i class="fas fa-check-circle me-2"></i>
                                    Producto Activo
                                </label>
                                <div class="form-check-description">
                                    Los productos activos son visibles para los clientes en la tienda
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ================================================
                     ACCIONES DEL FORMULARIO
                     ================================================ -->
                <div class="form-actions">
                    <button type="submit" class="btn btn-submit">
                        <i class="fas fa-save"></i>
                        Guardar Producto
                    </button>
                    <a asp-action="Index" class="btn btn-cancel">
                        <i class="fas fa-times"></i>
                        Cancelar
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script src="~/js/create_producto.js"></script>
    
    <script>
        // Prevenir envío duplicado del formulario
        document.getElementById('productForm').addEventListener('submit', function(e) {
            const submitBtn = this.querySelector('.btn-submit');
            if (submitBtn.disabled) {
                e.preventDefault();
                return false;
            }
        });
    </script>
}